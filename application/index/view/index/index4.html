{extend name='base'/}


{block name='content'}

<div class="container">
    <div class="contar-wrap">

        <h4 class="item-title notice_head">
            <i class="layui-icon layui-icon-speaker notice_text1" style="font-size: 30px; color: #1E9FFF;"></i><span class="notice_text2">公告：</span>
            <div id="FontScroll">
                <ul>
                    {foreach name="affiche" item="v"}
                    <li><a href="#">{$v['aff_content']}</a></li>
                    {/foreach}
<!--                    <li><a href="#">欢迎来到我的轻博客2</a></li>
                    <li><a href="#">欢迎来到我的轻博客3</a></li>
                    <li> <span>欢迎来到我的轻博客4</span></li>
                    <li> <span>欢迎来到我的轻博客5</span></li>-->
                </ul>
            </div>


        </h4>
        {foreach name='articles' item='art'}
        <div class="item">
            <div class="item-box  layer-photos-demo1 layer-photos-demo">
                <h3><a href="{:url('article/index',['art_id'=>$art['arc_id']])}">{$art['arc_title']}</a></h3>
                <h5>发布于：<span class="update_time">{$art['updatetime']}</span>
                    &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
                    <i class="layui-icon layui-icon-note"></i>

                    {foreach name="art['tags']" item='v'}
                    <a href="{:url('tag/index',['tag_id'=>$v['tag_id']])}"
                       class="layui-btn layui-btn-xs layui-btn-radius  layui-anim layui-anim-up layui-anim-scale">{$v['tag_name']}</a>
                    {/foreach}</h5>
                <p> {$art['arc_digest']}</p>
                <img src="__STATIC__/res/static/images/item.png" alt="">
            </div>
            <div class="comment count">
                <a href="{:url('article/index',['art_id'=>$art['arc_id']])}#comment">评论({$art['review_count']})</a>
                <a href="javascript:;" class="ilike" arc_id="{$art['arc_id']}">点赞(<span class="like_sum">{$art['likes']}</span>)</a>
                <!--<a href="" class="like ilike">点赞</a>-->
            </div>
        </div>
        {/foreach}
    </div>
    <div class="item-btn">
<!--        <button class="layui-btn layui-btn-normal">下一页</button>-->
{$articles->render()|raw}
    </div>

</div>
<style>

    ul li {
        list-style: none;
    }

    #FontScroll {
        display: inline-block;
        width: 500px;
        height: 30px;
        line-height: 30px;
        border: 1px solid transparent;/*边框*/
        overflow: Hidden;
        padding: 5px 0;
    }

    #FontScroll .line {
        width: 100%;
    }

    #FontScroll .fontColor a {
        color: red;
    }
</style>
<style>
    .notice_head{
        line-height: 40px;
        height: 40px;
    }

</style>
<style>
    .notice_text1{
        position: relative;
        bottom: 11px;

    }
    .notice_text2{
        position: relative;
        bottom: 17px;

    }
</style>
<script>(function ($) {
    $.fn.FontScroll = function (options) {
        var d = {time:3000, s: 'fontColor', num: 1}
        var o = $.extend(d, options);


        this.children('ul').addClass('line');
        var _con = $('.line').eq(0);
        var _conH = _con.height(); //滚动总高度
        var _conChildH = _con.children().eq(0).height();//一次滚动高度
        var _temp = _conChildH;  //临时变量
        var _time = d.time;  //滚动间隔
        var _s = d.s;  //滚动间隔


        _con.clone().insertAfter(_con);//初始化克隆

        //样式控制
        var num = d.num;
        var _p = this.find('li');
        var allNum = _p.length;

        _p.eq(num).addClass(_s);


        var timeID = setInterval(Up, _time);
        this.hover(function () {
            clearInterval(timeID)
        }, function () {
            timeID = setInterval(Up, _time);
        });

        function Up() {
            _con.animate({marginTop: '-' + _conChildH});
            //样式控制
            _p.removeClass(_s);
            num += 1;
            _p.eq(num).addClass(_s);

            if (_conH == _conChildH) {
                _con.animate({marginTop: '-' + _conChildH}, "normal", over);
            } else {
                _conChildH += _temp;
            }
        }

        function over() {
            _con.attr("style", 'margin-top:0');
            _conChildH = _temp;
            num = 1;
            _p.removeClass(_s);
            _p.eq(num).addClass(_s);
        }
    }
})(jQuery);
$(function () {
    $('#FontScroll').FontScroll({time: 1000, num: 0});
});
</script>
<!--离开页面停止定时器,返回页面开启定时器-->
<script>

</script>


<script>
    /**/
    $(document).ready(function () {
        /*$('.update_time').each(function () {
            alert($(this).html())
        });*/
        layui.use('util', function () {
            var util = layui.util;
            $('.update_time').each(function () {
                $(this).text(util.timeAgo($(this).text() * 1000, true));

            });


        });
    });

</script>
<script>
    $('.ilike').click(function () {
        let arc_id=$(this).attr('arc_id');
        // alert($(this).children('.like_sum').text())
        let like_sum_obj=$(this).children('.like_sum');
        $.ajax({
            url:'{:url("index/like/like")}',
            data:{arc_id:arc_id},

            success:function (res) {
                if(res.code==0){
                    layer.msg(res.msg,function () {
                        location.href='{:url("index/login/index")}';
                    })
                }else if(res.code==1){

                    //已登录
                    layer.msg(res.msg);
                    if(res.msg=='已取消点赞!'){
                        var like_sum=parseInt(like_sum_obj.text());
                        like_sum--;
                        like_sum_obj.text(like_sum)
                    }else if(res.msg=='点赞成功!'){
                        var like_sum=parseInt(like_sum_obj.text());
                        like_sum++;
                        like_sum_obj.text(like_sum)
                    }
                }

                // alert(res.msg);
            }
        })
    });
</script>

{/block}


